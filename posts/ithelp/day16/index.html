<!doctype html><html lang=zh-tw dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Day 16：自動補全！coc.nvim | Simba's Blog</title><meta name=keywords content="cli,terminal,software development,vim,tmux,zsh"><meta name=description content="一個好的自動補全工具可以讓你工作效率翻倍，你不用再去查文件了，自動補全不僅可以告訴你這裡有什麼函數可以用，還會告訴你參數的型態、函數功能的說明，可以說是把文件都寫在 vim 裡面了。
以前我用的自動補全是 You Complete Me(YCM)，現在我選擇使用 coc.nvim 原因是他提供更多的補全來源、外掛和設定，而且可以用 nodejs 自製外掛，據說所有純 JS 寫的 VS code 外掛都可以裝（這個我沒實驗過，只是傳聞）。關於這兩個自動補全外掛的比較礙於篇幅請自行 Google。
安裝 coc.nvim 和一般的 vim 外掛一樣，都是用 vim-plug 安裝就可以了，在 ~/.config/nvim/plugin.vim 中新增以下設定
Plug 'neoclide/coc.nvim', {'branch': 'release'} so ~/.config/nvim/coc-config.vim 因為 coc 有很多設定，為了避免檔案太雜亂我把 coc 相關的設定移到另一個檔案，就像我們在 前天 做得一樣
接下來建立 ~/.config/nvim/coc-config.vim，不然等等載入設定檔 vim 會報錯
:!touch ~/.config/nvim/coc-config.vim :! {cmd} 可以執行外部命令
接下來存檔安裝
:w | PlugInstall 跑完後，重開 vim，coc 就裝好了
lsp 語言伺服器協定 在講 coc 之前必須先講 Language Server Protocol，簡稱 lsp，中文是「語言伺服器協定」。lsp 做的事是提供自動補全和 go to def，能做到這兩個功能的原因是因為 lsp 懂程式碼，他知道你寫的每個字代表什麼。為什麼 lsp 這麼強呢？因為 lsp 什麼都不懂，他把所有事情丟給 language server 處理，所以只要你有裝 language server，那麼 lsp 什麼語言都懂。"><meta name=author content="simba-fs"><link rel=canonical href=https://blog.simba-fs.dev/posts/ithelp/day16/><link crossorigin=anonymous href=/assets/css/stylesheet.min.48a18943c2fc15c38a372b8dde1f5e5dc0bc64fa6cb90f5a817d2f8c76b7f3ae.css integrity="sha256-SKGJQ8L8FcOKNyuN3h9eXcC8ZPpsuQ9agX0vjHa3864=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.2840b7fccd34145847db71a290569594bdbdb00047097f75d6495d162f5d7dff.js integrity="sha256-KEC3/M00FFhH23GikFaVlL29sABHCX911kldFi9dff8=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://blog.simba-fs.dev/images/icon/icon.png><link rel=icon type=image/png sizes=16x16 href=https://blog.simba-fs.dev/images/icon/icon-16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.simba-fs.dev/images/icon/icon-32.png><link rel=apple-touch-icon href=https://blog.simba-fs.dev/images/icon/icon.png><link rel=mask-icon href=https://blog.simba-fs.dev/images/icon/icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-175823992-1','auto'),ga('send','pageview'))</script><meta property="og:title" content="Day 16：自動補全！coc.nvim"><meta property="og:description" content="一個好的自動補全工具可以讓你工作效率翻倍，你不用再去查文件了，自動補全不僅可以告訴你這裡有什麼函數可以用，還會告訴你參數的型態、函數功能的說明，可以說是把文件都寫在 vim 裡面了。
以前我用的自動補全是 You Complete Me(YCM)，現在我選擇使用 coc.nvim 原因是他提供更多的補全來源、外掛和設定，而且可以用 nodejs 自製外掛，據說所有純 JS 寫的 VS code 外掛都可以裝（這個我沒實驗過，只是傳聞）。關於這兩個自動補全外掛的比較礙於篇幅請自行 Google。
安裝 coc.nvim 和一般的 vim 外掛一樣，都是用 vim-plug 安裝就可以了，在 ~/.config/nvim/plugin.vim 中新增以下設定
Plug 'neoclide/coc.nvim', {'branch': 'release'} so ~/.config/nvim/coc-config.vim 因為 coc 有很多設定，為了避免檔案太雜亂我把 coc 相關的設定移到另一個檔案，就像我們在 前天 做得一樣
接下來建立 ~/.config/nvim/coc-config.vim，不然等等載入設定檔 vim 會報錯
:!touch ~/.config/nvim/coc-config.vim :! {cmd} 可以執行外部命令
接下來存檔安裝
:w | PlugInstall 跑完後，重開 vim，coc 就裝好了
lsp 語言伺服器協定 在講 coc 之前必須先講 Language Server Protocol，簡稱 lsp，中文是「語言伺服器協定」。lsp 做的事是提供自動補全和 go to def，能做到這兩個功能的原因是因為 lsp 懂程式碼，他知道你寫的每個字代表什麼。為什麼 lsp 這麼強呢？因為 lsp 什麼都不懂，他把所有事情丟給 language server 處理，所以只要你有裝 language server，那麼 lsp 什麼語言都懂。"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.simba-fs.dev/posts/ithelp/day16/"><meta property="og:image" content="https://blog.simba-fs.dev/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-09-16T00:00:00+00:00"><meta property="article:modified_time" content="2021-09-16T00:00:00+00:00"><meta property="og:site_name" content="Simba 的喵窩"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.simba-fs.dev/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Day 16：自動補全！coc.nvim"><meta name=twitter:description content="一個好的自動補全工具可以讓你工作效率翻倍，你不用再去查文件了，自動補全不僅可以告訴你這裡有什麼函數可以用，還會告訴你參數的型態、函數功能的說明，可以說是把文件都寫在 vim 裡面了。
以前我用的自動補全是 You Complete Me(YCM)，現在我選擇使用 coc.nvim 原因是他提供更多的補全來源、外掛和設定，而且可以用 nodejs 自製外掛，據說所有純 JS 寫的 VS code 外掛都可以裝（這個我沒實驗過，只是傳聞）。關於這兩個自動補全外掛的比較礙於篇幅請自行 Google。
安裝 coc.nvim 和一般的 vim 外掛一樣，都是用 vim-plug 安裝就可以了，在 ~/.config/nvim/plugin.vim 中新增以下設定
Plug 'neoclide/coc.nvim', {'branch': 'release'} so ~/.config/nvim/coc-config.vim 因為 coc 有很多設定，為了避免檔案太雜亂我把 coc 相關的設定移到另一個檔案，就像我們在 前天 做得一樣
接下來建立 ~/.config/nvim/coc-config.vim，不然等等載入設定檔 vim 會報錯
:!touch ~/.config/nvim/coc-config.vim :! {cmd} 可以執行外部命令
接下來存檔安裝
:w | PlugInstall 跑完後，重開 vim，coc 就裝好了
lsp 語言伺服器協定 在講 coc 之前必須先講 Language Server Protocol，簡稱 lsp，中文是「語言伺服器協定」。lsp 做的事是提供自動補全和 go to def，能做到這兩個功能的原因是因為 lsp 懂程式碼，他知道你寫的每個字代表什麼。為什麼 lsp 這麼強呢？因為 lsp 什麼都不懂，他把所有事情丟給 language server 處理，所以只要你有裝 language server，那麼 lsp 什麼語言都懂。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"posts","item":"https://blog.simba-fs.dev/posts/"},{"@type":"ListItem","position":2,"name":"ithelp","item":"https://blog.simba-fs.dev/posts/ithelp/"},{"@type":"ListItem","position":3,"name":"Day 16：自動補全！coc.nvim","item":"https://blog.simba-fs.dev/posts/ithelp/day16/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Day 16：自動補全！coc.nvim","name":"Day 16：自動補全！coc.nvim","description":"一個好的自動補全工具可以讓你工作效率翻倍，你不用再去查文件了，自動補全不僅可以告訴你這裡有什麼函數可以用，還會告訴你參數的型態、函數功能的說明，可以說是把文件都寫在 vim 裡面了。\n以前我用的自動補全是 You Complete Me(YCM)，現在我選擇使用 coc.nvim 原因是他提供更多的補全來源、外掛和設定，而且可以用 nodejs 自製外掛，據說所有純 JS 寫的 VS code 外掛都可以裝（這個我沒實驗過，只是傳聞）。關於這兩個自動補全外掛的比較礙於篇幅請自行 Google。\n安裝 coc.nvim 和一般的 vim 外掛一樣，都是用 vim-plug 安裝就可以了，在 ~/.config/nvim/plugin.vim 中新增以下設定\nPlug \u0026#39;neoclide/coc.nvim\u0026#39;, {\u0026#39;branch\u0026#39;: \u0026#39;release\u0026#39;} so ~/.config/nvim/coc-config.vim 因為 coc 有很多設定，為了避免檔案太雜亂我把 coc 相關的設定移到另一個檔案，就像我們在 前天 做得一樣\n接下來建立 ~/.config/nvim/coc-config.vim，不然等等載入設定檔 vim 會報錯\n:!touch ~/.config/nvim/coc-config.vim :! {cmd} 可以執行外部命令\n接下來存檔安裝\n:w | PlugInstall 跑完後，重開 vim，coc 就裝好了\nlsp 語言伺服器協定 在講 coc 之前必須先講 Language Server Protocol，簡稱 lsp，中文是「語言伺服器協定」。lsp 做的事是提供自動補全和 go to def，能做到這兩個功能的原因是因為 lsp 懂程式碼，他知道你寫的每個字代表什麼。為什麼 lsp 這麼強呢？因為 lsp 什麼都不懂，他把所有事情丟給 language server 處理，所以只要你有裝 language server，那麼 lsp 什麼語言都懂。","keywords":["cli","terminal","software development","vim","tmux","zsh"],"articleBody":"一個好的自動補全工具可以讓你工作效率翻倍，你不用再去查文件了，自動補全不僅可以告訴你這裡有什麼函數可以用，還會告訴你參數的型態、函數功能的說明，可以說是把文件都寫在 vim 裡面了。\n以前我用的自動補全是 You Complete Me(YCM)，現在我選擇使用 coc.nvim 原因是他提供更多的補全來源、外掛和設定，而且可以用 nodejs 自製外掛，據說所有純 JS 寫的 VS code 外掛都可以裝（這個我沒實驗過，只是傳聞）。關於這兩個自動補全外掛的比較礙於篇幅請自行 Google。\n安裝 coc.nvim 和一般的 vim 外掛一樣，都是用 vim-plug 安裝就可以了，在 ~/.config/nvim/plugin.vim 中新增以下設定\nPlug 'neoclide/coc.nvim', {'branch': 'release'} so ~/.config/nvim/coc-config.vim 因為 coc 有很多設定，為了避免檔案太雜亂我把 coc 相關的設定移到另一個檔案，就像我們在 前天 做得一樣\n接下來建立 ~/.config/nvim/coc-config.vim，不然等等載入設定檔 vim 會報錯\n:!touch ~/.config/nvim/coc-config.vim :! {cmd} 可以執行外部命令\n接下來存檔安裝\n:w | PlugInstall 跑完後，重開 vim，coc 就裝好了\nlsp 語言伺服器協定 在講 coc 之前必須先講 Language Server Protocol，簡稱 lsp，中文是「語言伺服器協定」。lsp 做的事是提供自動補全和 go to def，能做到這兩個功能的原因是因為 lsp 懂程式碼，他知道你寫的每個字代表什麼。為什麼 lsp 這麼強呢？因為 lsp 什麼都不懂，他把所有事情丟給 language server 處理，所以只要你有裝 language server，那麼 lsp 什麼語言都懂。\n這麼神奇的 lsp 就是大名鼎鼎的 vs code 提出的（難怪是最多人用的編輯器），我們深耕 45 年的 vim 當然要跟上，所以 coc.nvim 出現了，他是一個 vim 的 language client，而重點是非常好用！\n安裝 coc 擴充 剛剛說了 coc 的主要功能是把所有事情丟給別人做，那麼這個「人」設定聽起來就很麻煩，所以 coc 有個好主意，用擴充（ extension ）解決！你只要裝好擴充差不多就設定好 lsp 了\ncoc.nvim 的自動補全選字來源除了目前所有的 buffer（開啟的檔案）之外，還有 coc 擴充。\ncoc 擴充安裝很簡單，在 vim 裡面下指令 :CocInstall {extension}，那麼這個擴充的名字該去哪裡找呢？一個是 coc.nvim 的 GitHub Wiki，另一個是去 npm 搜尋 coc，稍微過濾一下大部分都是 coc.nvim 的擴充。\n剛剛講的安裝方法有一個缺點，就是當你今天要搬電腦時你要全部手動再安裝一次，這時候就有點麻煩了。所以你可以在 ~/.config/nvim/coc-config.vim 中寫下我們第一個 coc 設定\nlet g:coc_global_extensions = [ \\ 'coc-extension-1', \\ 'coc-extension-2' \\ ] 這個變數儲存的是 coc 擴充的名字（就是你安裝時用的那個），coc 啟動如果沒安裝他就會自己去裝了，所以手動安裝好擴充後記得在這裡寫一下，為以後搬電腦做打算\n你也可以用 :CocList extensions 列出現在安裝的擴充\n至於要裝什麼擴充，這個就要看你要寫什麼程式語言了，自己去上面介紹的兩個地方找你需要的，我這裡就不多介紹\n基本設定 因為 coc 可能是你在寫程式時最常用的外掛，所以為了避免有快捷鍵衝突，coc 預設不會有任何的按鍵綁定，所以你必須自己寫全部的 keymap，在 coc.nvim 的 GitHub README.md 有範例，接下來的設定都是從這裡面挑出來的。\n以下是我覺得必須的設定，我會把註解翻成中文，有些在範例上標明「可能」、「某些情況」的設定我不會納進來，當你遇到奇怪問題時再去看看範例和 issue\n\" 太長的更新間隔會導致明顯的延遲並降低使用者體驗（預設是 4000 ms = 4s ） set updatetime=300 \" 永遠顯示 signcolumn（行號左邊那個，這我不知道怎麼翻），否則每當有診斷出來時整個程式碼就會被往右移 if has(\"nvim-0.5.0\") || has(\"patch-8.1.1564\") \" 新的版本可以把 signcolumn 和行號合併（這個我版本不夠沒看過，有人知道會長怎樣可以下面留言嗎？） set signcolumn=number else set signcolumn=yes endif \" 用 tab 鍵觸發自動補全 \" 注意：載入設定後記得用命令 `verbose imap ` 確定這沒有被其他外掛覆蓋掉 inoremap \u003csilent\u003e\u003cexpr\u003e \u003cTAB\u003e \\ pumvisible() ? \"\\\" : \\ \u003cSID\u003echeck_back_space() ? \"\\\" : \\ coc#refresh() inoremap \u003cexpr\u003e\u003cS-TAB\u003e pumvisible() ? \"\\\" : \"\\\" function! s:check_back_space() abort let col = col('.') - 1 return !col || getline('.')[col - 1] =~# '\\s' endfunction \" 讓 enter 鍵自動完成第一個建議並讓 coc 進行格式化（不確定個格式化指的是什麼，我看不太出來） \" enter 可以被重複 keymap（看不懂就算了，意思是你亂搞不會出錯） inoremap \u003csilent\u003e\u003cexpr\u003e \u003ccr\u003e pumvisible() ? coc#_select_confirm() \\: \"\\u\\\\=coc#on_enter()\\\" \" 用 \\rn 重新命名變數、函數（原文寫「符號」） nmap \u003cleader\u003ern \u003cPlug\u003e(coc-rename) \" 這個讓你可以捲動浮動視窗和跳出式框框（有時候自動補全給你的文件會太長超出螢幕，如果你想要看下面的內容必須設定這個） if has('nvim-0.4.0') || has('patch-8.2.0750') nnoremap \u003csilent\u003e\u003cnowait\u003e\u003cexpr\u003e \u003cC-f\u003e coc#float#has_scroll() ? coc#float#scroll(1) : \"\\\" nnoremap \u003csilent\u003e\u003cnowait\u003e\u003cexpr\u003e \u003cC-b\u003e coc#float#has_scroll() ? coc#float#scroll(0) : \"\\\" inoremap \u003csilent\u003e\u003cnowait\u003e\u003cexpr\u003e \u003cC-f\u003e coc#float#has_scroll() ? \"\\=coc#float#scroll(1)\\\" : \"\\\" inoremap \u003csilent\u003e\u003cnowait\u003e\u003cexpr\u003e \u003cC-b\u003e coc#float#has_scroll() ? \"\\=coc#float#scroll(0)\\\" : \"\\\" vnoremap \u003csilent\u003e\u003cnowait\u003e\u003cexpr\u003e \u003cC-f\u003e coc#float#has_scroll() ? coc#float#scroll(1) : \"\\\" vnoremap \u003csilent\u003e\u003cnowait\u003e\u003cexpr\u003e \u003cC-b\u003e coc#float#has_scroll() ? coc#float#scroll(0) : \"\\\" endif 結尾 coc.nvim 的設定真的很多，一眼看上去會覺得很煩，但是認真看完設定好後的 vim 真的會讓你過得非常舒服。\n明天是我今天沒有介紹到的部份，大部份是超難記的快捷鍵。一樣都會有全中文翻譯（但是有些我真的沒用過，只能硬著頭皮翻譯了）\n","wordCount":"328","inLanguage":"zh-tw","datePublished":"2021-09-16T00:00:00Z","dateModified":"2021-09-16T00:00:00Z","author":{"@type":"Person","name":"simba-fs"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.simba-fs.dev/posts/ithelp/day16/"},"publisher":{"@type":"Organization","name":"Simba's Blog","logo":{"@type":"ImageObject","url":"https://blog.simba-fs.dev/images/icon/icon.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><header class=header><nav class=nav><div class=logo><a href=https://blog.simba-fs.dev/ accesskey=h title="Home (Alt + H)"><img src=https://blog.simba-fs.dev/images/icon/icon.png alt=logo aria-label=logo height=35>Home</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://blog.simba-fs.dev/posts/ title=Categories><span>Categories</span></a></li><li><a href=https://blog.simba-fs.dev/archive/ title=Archives><span>Archives</span></a></li><li><a href=https://blog.simba-fs.dev/resource/ title=Resource><span>Resource</span></a></li><li><a href=https://blog.simba-fs.dev/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.simba-fs.dev/>首頁</a>&nbsp;»&nbsp;<a href=https://blog.simba-fs.dev/posts/>posts</a>&nbsp;»&nbsp;<a href=https://blog.simba-fs.dev/posts/ithelp/>ithelp</a></div><h1 class=post-title>Day 16：自動補全！coc.nvim</h1><div class=post-meta><span title='2021-09-16 00:00:00 +0000 UTC'>2021-September-16</span>&nbsp;·&nbsp;2 分鐘&nbsp;·&nbsp;simba-fs</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>目錄</span></summary><div class=inner><ul><li><a href=#%e5%ae%89%e8%a3%9d aria-label=安裝>安裝</a></li><li><a href=#lsp-%e8%aa%9e%e8%a8%80%e4%bc%ba%e6%9c%8d%e5%99%a8%e5%8d%94%e5%ae%9a aria-label="lsp 語言伺服器協定">lsp 語言伺服器協定</a></li><li><a href=#%e5%ae%89%e8%a3%9d-coc-%e6%93%b4%e5%85%85 aria-label="安裝 coc 擴充">安裝 coc 擴充</a></li><li><a href=#%e5%9f%ba%e6%9c%ac%e8%a8%ad%e5%ae%9a aria-label=基本設定>基本設定</a></li><li><a href=#%e7%b5%90%e5%b0%be aria-label=結尾>結尾</a></li></ul></div></details></div><div class=post-content><p>一個好的自動補全工具可以讓你工作效率翻倍，你不用再去查文件了，自動補全不僅可以告訴你這裡有什麼函數可以用，還會告訴你參數的型態、函數功能的說明，可以說是把文件都寫在 vim 裡面了。<br>以前我用的自動補全是 <a href=https://github.com/ycm-core/YouCompleteMe>You Complete Me(YCM)</a>，現在我選擇使用 <a href=https://github.com/neoclide/coc.nvim>coc.nvim</a> 原因是他提供更多的補全來源、外掛和設定，而且可以用 nodejs 自製外掛，據說所有純 JS 寫的 VS code 外掛都可以裝（這個我沒實驗過，只是傳聞）。關於這兩個自動補全外掛的比較礙於篇幅請自行 Google。</p><h1 id=安裝>安裝<a hidden class=anchor aria-hidden=true href=#安裝>#</a></h1><p>coc.nvim 和一般的 vim 外掛一樣，都是用 vim-plug 安裝就可以了，在 <code>~/.config/nvim/plugin.vim</code> 中新增以下設定</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#a6e22e>Plug</span> <span style=color:#e6db74>&#39;neoclide/coc.nvim&#39;</span>, {<span style=color:#e6db74>&#39;branch&#39;</span>: <span style=color:#e6db74>&#39;release&#39;</span>}<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#a6e22e>so</span> ~<span style=color:#e6db74>/.config/</span><span style=color:#a6e22e>nvim</span>/<span style=color:#a6e22e>coc</span>-<span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>vim</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>因為 coc 有很多設定，為了避免檔案太雜亂我把 coc 相關的設定移到另一個檔案，就像我們在 <a href=../day14/#%E5%88%87%E5%88%86-vimrc>前天</a> 做得一樣<br>接下來建立 <code>~/.config/nvim/coc-config.vim</code>，不然等等載入設定檔 vim 會報錯</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vim data-lang=vim><span style=display:flex><span>:!<span style=color:#a6e22e>touch</span> ~<span style=color:#e6db74>/.config/</span><span style=color:#a6e22e>nvim</span>/<span style=color:#a6e22e>coc</span>-<span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>vim</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><blockquote><p><code>:! {cmd}</code> 可以執行外部命令</p></blockquote><p>接下來存檔安裝</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vim data-lang=vim><span style=display:flex><span>:<span style=color:#a6e22e>w</span> | <span style=color:#a6e22e>PlugInstall</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>跑完後，重開 vim，coc 就裝好了</p><h1 id=lsp-語言伺服器協定>lsp 語言伺服器協定<a hidden class=anchor aria-hidden=true href=#lsp-語言伺服器協定>#</a></h1><p>在講 coc 之前必須先講 Language Server Protocol，簡稱 lsp，中文是「語言伺服器協定」。lsp 做的事是提供自動補全和 go to def，能做到這兩個功能的原因是因為 lsp 懂程式碼，他知道你寫的每個字代表什麼。為什麼 lsp 這麼強呢？因為 lsp 什麼都不懂，他把所有事情丟給 language server 處理，所以只要你有裝 language server，那麼 lsp 什麼語言都懂。<br>這麼神奇的 lsp 就是大名鼎鼎的 vs code 提出的（難怪是最多人用的編輯器），我們深耕 45 年的 vim 當然要跟上，所以 coc.nvim 出現了，他是一個 vim 的 language client，而重點是非常好用！</p><h1 id=安裝-coc-擴充>安裝 coc 擴充<a hidden class=anchor aria-hidden=true href=#安裝-coc-擴充>#</a></h1><p>剛剛說了 coc 的主要功能是把所有事情丟給別人做，那麼這個「人」設定聽起來就很麻煩，所以 coc 有個好主意，用擴充（ extension ）解決！你只要裝好擴充差不多就設定好 lsp 了<br>coc.nvim 的自動補全選字來源除了目前所有的 buffer（開啟的檔案）之外，還有 coc 擴充。<br>coc 擴充安裝很簡單，在 vim 裡面下指令 <code>:CocInstall {extension}</code>，那麼這個擴充的名字該去哪裡找呢？一個是 <a href=https://github.com/neoclide/coc.nvim/wiki/Using-coc-extensions#implemented-coc-extensions>coc.nvim 的 GitHub Wiki</a>，另一個是去 <a href=https://npmjs.org>npm</a> 搜尋 <code>coc</code>，稍微過濾一下大部分都是 coc.nvim 的擴充。</p><p>剛剛講的安裝方法有一個缺點，就是當你今天要搬電腦時你要全部手動再安裝一次，這時候就有點麻煩了。所以你可以在 <code>~/.config/nvim/coc-config.vim</code> 中寫下我們第一個 coc 設定</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>g</span>:<span style=color:#a6e22e>coc_global_extensions</span> = [<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>\ <span style=color:#e6db74>&#39;coc-extension-1&#39;</span>,<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>\ <span style=color:#e6db74>&#39;coc-extension-2&#39;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>\ ]<span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>這個變數儲存的是 coc 擴充的名字（就是你安裝時用的那個），coc 啟動如果沒安裝他就會自己去裝了，所以手動安裝好擴充後記得在這裡寫一下，為以後搬電腦做打算<br>你也可以用 <code>:CocList extensions</code> 列出現在安裝的擴充<br>至於要裝什麼擴充，這個就要看你要寫什麼程式語言了，自己去上面介紹的兩個地方找你需要的，我這裡就不多介紹</p><h1 id=基本設定>基本設定<a hidden class=anchor aria-hidden=true href=#基本設定>#</a></h1><p>因為 coc 可能是你在寫程式時最常用的外掛，所以為了避免有快捷鍵衝突，coc 預設不會有任何的按鍵綁定，所以你必須自己寫全部的 keymap，在 <a href=https://github.com/neoclide/coc.nvim#example-vim-configuration>coc.nvim 的 GitHub README.md</a> 有範例，接下來的設定都是從這裡面挑出來的。<br>以下是我覺得必須的設定，我會把註解翻成中文，有些在範例上標明「可能」、「某些情況」的設定我不會納進來，當你遇到奇怪問題時再去看看範例和 issue</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#75715e>&#34; 太長的更新間隔會導致明顯的延遲並降低使用者體驗（預設是 4000 ms = 4s ）</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#a6e22e>set</span> <span style=color:#a6e22e>updatetime</span>=<span style=color:#ae81ff>300</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>&#34; 永遠顯示 signcolumn（行號左邊那個，這我不知道怎麼翻），否則每當有診斷出來時整個程式碼就會被往右移</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>has</span>(<span style=color:#e6db74>&#34;nvim-0.5.0&#34;</span>) || <span style=color:#a6e22e>has</span>(<span style=color:#e6db74>&#34;patch-8.1.1564&#34;</span>)<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e>  &#34; 新的版本可以把 signcolumn 和行號合併（這個我版本不夠沒看過，有人知道會長怎樣可以下面留言嗎？）</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>  <span style=color:#a6e22e>set</span> <span style=color:#a6e22e>signcolumn</span>=<span style=color:#a6e22e>number</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>else</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>  <span style=color:#a6e22e>set</span> <span style=color:#a6e22e>signcolumn</span>=<span style=color:#a6e22e>yes</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>endif</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>&#34; 用 tab 鍵觸發自動補全</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e>&#34; 注意：載入設定後記得用命令 `verbose imap &lt;tab&gt;` 確定這沒有被其他外掛覆蓋掉</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#a6e22e>inoremap</span> &lt;<span style=color:#a6e22e>silent</span>&gt;&lt;<span style=color:#a6e22e>expr</span>&gt; &lt;<span style=color:#a6e22e>TAB</span>&gt;<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>	\ <span style=color:#a6e22e>pumvisible</span>() ? <span style=color:#e6db74>&#34;\&lt;C-n&gt;&#34;</span> :<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>	\ &lt;<span style=color:#a6e22e>SID</span>&gt;<span style=color:#a6e22e>check_back_space</span>() ? <span style=color:#e6db74>&#34;\&lt;TAB&gt;&#34;</span> :<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>	\ <span style=color:#a6e22e>coc</span>#<span style=color:#a6e22e>refresh</span>()<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#a6e22e>inoremap</span> &lt;<span style=color:#a6e22e>expr</span>&gt;&lt;<span style=color:#a6e22e>S</span>-<span style=color:#a6e22e>TAB</span>&gt; <span style=color:#a6e22e>pumvisible</span>() ? <span style=color:#e6db74>&#34;\&lt;C-p&gt;&#34;</span> : <span style=color:#e6db74>&#34;\&lt;C-h&gt;&#34;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>function</span>! <span style=color:#a6e22e>s</span>:<span style=color:#a6e22e>check_back_space</span>() <span style=color:#a6e22e>abort</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>	<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>col</span> = <span style=color:#a6e22e>col</span>(<span style=color:#e6db74>&#39;.&#39;</span>) - <span style=color:#ae81ff>1</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>	<span style=color:#a6e22e>return</span> !<span style=color:#a6e22e>col</span> || <span style=color:#a6e22e>getline</span>(<span style=color:#e6db74>&#39;.&#39;</span>)[<span style=color:#a6e22e>col</span> - <span style=color:#ae81ff>1</span>]  =~# <span style=color:#e6db74>&#39;\s&#39;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>endfunction</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>&#34; 讓 enter 鍵自動完成第一個建議並讓 coc 進行格式化（不確定個格式化指的是什麼，我看不太出來）</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e>&#34; enter 可以被重複 keymap（看不懂就算了，意思是你亂搞不會出錯）</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#a6e22e>inoremap</span> &lt;<span style=color:#a6e22e>silent</span>&gt;&lt;<span style=color:#a6e22e>expr</span>&gt; &lt;<span style=color:#a6e22e>cr</span>&gt; <span style=color:#a6e22e>pumvisible</span>() ? <span style=color:#a6e22e>coc</span>#<span style=color:#a6e22e>_select_confirm</span>()<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>	\: <span style=color:#e6db74>&#34;\&lt;C-g&gt;u\&lt;CR&gt;\&lt;c-r&gt;=coc#on_enter()\&lt;CR&gt;&#34;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>&#34; 用 \rn 重新命名變數、函數（原文寫「符號」）</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#a6e22e>nmap</span> &lt;<span style=color:#a6e22e>leader</span>&gt;<span style=color:#a6e22e>rn</span> &lt;<span style=color:#a6e22e>Plug</span>&gt;(<span style=color:#a6e22e>coc</span>-<span style=color:#a6e22e>rename</span>)<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>&#34; 這個讓你可以捲動浮動視窗和跳出式框框（有時候自動補全給你的文件會太長超出螢幕，如果你想要看下面的內容必須設定這個）</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>has</span>(<span style=color:#e6db74>&#39;nvim-0.4.0&#39;</span>) || <span style=color:#a6e22e>has</span>(<span style=color:#e6db74>&#39;patch-8.2.0750&#39;</span>)<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>  <span style=color:#a6e22e>nnoremap</span> &lt;<span style=color:#a6e22e>silent</span>&gt;&lt;<span style=color:#a6e22e>nowait</span>&gt;&lt;<span style=color:#a6e22e>expr</span>&gt; &lt;<span style=color:#a6e22e>C</span>-<span style=color:#a6e22e>f</span>&gt; <span style=color:#a6e22e>coc</span>#<span style=color:#a6e22e>float</span>#<span style=color:#a6e22e>has_scroll</span>() ? <span style=color:#a6e22e>coc</span>#<span style=color:#a6e22e>float</span>#<span style=color:#a6e22e>scroll</span>(<span style=color:#ae81ff>1</span>) : <span style=color:#e6db74>&#34;\&lt;C-f&gt;&#34;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>  <span style=color:#a6e22e>nnoremap</span> &lt;<span style=color:#a6e22e>silent</span>&gt;&lt;<span style=color:#a6e22e>nowait</span>&gt;&lt;<span style=color:#a6e22e>expr</span>&gt; &lt;<span style=color:#a6e22e>C</span>-<span style=color:#a6e22e>b</span>&gt; <span style=color:#a6e22e>coc</span>#<span style=color:#a6e22e>float</span>#<span style=color:#a6e22e>has_scroll</span>() ? <span style=color:#a6e22e>coc</span>#<span style=color:#a6e22e>float</span>#<span style=color:#a6e22e>scroll</span>(<span style=color:#ae81ff>0</span>) : <span style=color:#e6db74>&#34;\&lt;C-b&gt;&#34;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>  <span style=color:#a6e22e>inoremap</span> &lt;<span style=color:#a6e22e>silent</span>&gt;&lt;<span style=color:#a6e22e>nowait</span>&gt;&lt;<span style=color:#a6e22e>expr</span>&gt; &lt;<span style=color:#a6e22e>C</span>-<span style=color:#a6e22e>f</span>&gt; <span style=color:#a6e22e>coc</span>#<span style=color:#a6e22e>float</span>#<span style=color:#a6e22e>has_scroll</span>() ? <span style=color:#e6db74>&#34;\&lt;c-r&gt;=coc#float#scroll(1)\&lt;cr&gt;&#34;</span> : <span style=color:#e6db74>&#34;\&lt;Right&gt;&#34;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>  <span style=color:#a6e22e>inoremap</span> &lt;<span style=color:#a6e22e>silent</span>&gt;&lt;<span style=color:#a6e22e>nowait</span>&gt;&lt;<span style=color:#a6e22e>expr</span>&gt; &lt;<span style=color:#a6e22e>C</span>-<span style=color:#a6e22e>b</span>&gt; <span style=color:#a6e22e>coc</span>#<span style=color:#a6e22e>float</span>#<span style=color:#a6e22e>has_scroll</span>() ? <span style=color:#e6db74>&#34;\&lt;c-r&gt;=coc#float#scroll(0)\&lt;cr&gt;&#34;</span> : <span style=color:#e6db74>&#34;\&lt;Left&gt;&#34;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>  <span style=color:#a6e22e>vnoremap</span> &lt;<span style=color:#a6e22e>silent</span>&gt;&lt;<span style=color:#a6e22e>nowait</span>&gt;&lt;<span style=color:#a6e22e>expr</span>&gt; &lt;<span style=color:#a6e22e>C</span>-<span style=color:#a6e22e>f</span>&gt; <span style=color:#a6e22e>coc</span>#<span style=color:#a6e22e>float</span>#<span style=color:#a6e22e>has_scroll</span>() ? <span style=color:#a6e22e>coc</span>#<span style=color:#a6e22e>float</span>#<span style=color:#a6e22e>scroll</span>(<span style=color:#ae81ff>1</span>) : <span style=color:#e6db74>&#34;\&lt;C-f&gt;&#34;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>  <span style=color:#a6e22e>vnoremap</span> &lt;<span style=color:#a6e22e>silent</span>&gt;&lt;<span style=color:#a6e22e>nowait</span>&gt;&lt;<span style=color:#a6e22e>expr</span>&gt; &lt;<span style=color:#a6e22e>C</span>-<span style=color:#a6e22e>b</span>&gt; <span style=color:#a6e22e>coc</span>#<span style=color:#a6e22e>float</span>#<span style=color:#a6e22e>has_scroll</span>() ? <span style=color:#a6e22e>coc</span>#<span style=color:#a6e22e>float</span>#<span style=color:#a6e22e>scroll</span>(<span style=color:#ae81ff>0</span>) : <span style=color:#e6db74>&#34;\&lt;C-b&gt;&#34;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>endif</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><h1 id=結尾>結尾<a hidden class=anchor aria-hidden=true href=#結尾>#</a></h1><p>coc.nvim 的設定真的很多，一眼看上去會覺得很煩，但是認真看完設定好後的 vim 真的會讓你過得非常舒服。<br>明天是我今天沒有介紹到的部份，大部份是超難記的快捷鍵。一樣都會有全中文翻譯（但是有些我真的沒用過，只能硬著頭皮翻譯了）</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.simba-fs.dev/tags/cli/>cli</a></li><li><a href=https://blog.simba-fs.dev/tags/terminal/>terminal</a></li><li><a href=https://blog.simba-fs.dev/tags/software-development/>software development</a></li><li><a href=https://blog.simba-fs.dev/tags/vim/>vim</a></li><li><a href=https://blog.simba-fs.dev/tags/tmux/>tmux</a></li><li><a href=https://blog.simba-fs.dev/tags/zsh/>zsh</a></li></ul><nav class=paginav><a class=prev href=https://blog.simba-fs.dev/posts/ithelp/day17/><span class=title>« 上一篇</span><br><span>Day 17：coc.nvim 設定下集</span></a>
<a class=next href=https://blog.simba-fs.dev/posts/ithelp/day15/><span class=title>下一篇 »</span><br><span>Day 15：vim 外掛大雜燴！</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://blog.simba-fs.dev/>Simba's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>