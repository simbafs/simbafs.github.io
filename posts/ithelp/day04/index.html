<!doctype html><html lang=zh-tw dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Day 04：金魚記憶力太短暫，交給外掛記吧！autosuggestions 與 sugstring-search | Simba's Blog</title><meta name=keywords content="cli,terminal,software development,vim,tmux,zsh"><meta name=description content="今天的內容會比平常多，但是非常紮實！
有時候我們在 CLI 操作時遇到很多重複的指令，像是 git add、git commit -m 'ba la ba la' 等等，這些指令可能又長又複雜，一直都是自己打也不是辦法，這時候就該請出 autosuggestions 了
安裝 autosuggestions 老樣子，安裝外掛只須要修改 ~/.zshrc 就可以了
# plugins zplug 'romkatv/powerlevel10k', as:theme, depth:1 + zplug 'zsh-users/zsh-autosuggestions' 因為 autosuggestions 是外掛，不需要特別寫 tag 了
[問題]好像有奇怪的字跑出來？ 寫好之後重開終端機，按下 enter你可能會發現跳出了一堆東西，這是因為你開啟了 p10k 的 Instant Prompt Mode，這個雖然會讓你的終端機跑起來比較順（官方說的，我感覺不出來），但是在 zsh 載入完成之前就不能有任何字輸出。
可是你看看，如果我們新增了一個外掛，zplug 會跳出來問我們是否要安裝，這時後 Instant Prompt Mode 就出來抱怨了。
這個問題的解決方法直覺上有兩個，一是關掉 Instant Prompt Mode，二是讓 zplug 先不要吵
關掉 Instant Prompt Mode 關掉 Instant Prompt Mode 很簡單，重新設定一次 p10k 就好了，在設定程式問你是否要開啟 p10k 時選擇 (3) Off，這樣下次安裝外掛就不會有奇怪的警告訊息跳出來了。"><meta name=author content="simba-fs"><link rel=canonical href=https://blog.simba-fs.dev/posts/ithelp/day04/><link crossorigin=anonymous href=/assets/css/stylesheet.min.48a18943c2fc15c38a372b8dde1f5e5dc0bc64fa6cb90f5a817d2f8c76b7f3ae.css integrity="sha256-SKGJQ8L8FcOKNyuN3h9eXcC8ZPpsuQ9agX0vjHa3864=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.2840b7fccd34145847db71a290569594bdbdb00047097f75d6495d162f5d7dff.js integrity="sha256-KEC3/M00FFhH23GikFaVlL29sABHCX911kldFi9dff8=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://blog.simba-fs.dev/images/icon/icon.png><link rel=icon type=image/png sizes=16x16 href=https://blog.simba-fs.dev/images/icon/icon-16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.simba-fs.dev/images/icon/icon-32.png><link rel=apple-touch-icon href=https://blog.simba-fs.dev/images/icon/icon.png><link rel=mask-icon href=https://blog.simba-fs.dev/images/icon/icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-175823992-1","auto"),ga("send","pageview"))</script><meta property="og:title" content="Day 04：金魚記憶力太短暫，交給外掛記吧！autosuggestions 與 sugstring-search"><meta property="og:description" content="今天的內容會比平常多，但是非常紮實！
有時候我們在 CLI 操作時遇到很多重複的指令，像是 git add、git commit -m 'ba la ba la' 等等，這些指令可能又長又複雜，一直都是自己打也不是辦法，這時候就該請出 autosuggestions 了
安裝 autosuggestions 老樣子，安裝外掛只須要修改 ~/.zshrc 就可以了
# plugins zplug 'romkatv/powerlevel10k', as:theme, depth:1 + zplug 'zsh-users/zsh-autosuggestions' 因為 autosuggestions 是外掛，不需要特別寫 tag 了
[問題]好像有奇怪的字跑出來？ 寫好之後重開終端機，按下 enter你可能會發現跳出了一堆東西，這是因為你開啟了 p10k 的 Instant Prompt Mode，這個雖然會讓你的終端機跑起來比較順（官方說的，我感覺不出來），但是在 zsh 載入完成之前就不能有任何字輸出。
可是你看看，如果我們新增了一個外掛，zplug 會跳出來問我們是否要安裝，這時後 Instant Prompt Mode 就出來抱怨了。
這個問題的解決方法直覺上有兩個，一是關掉 Instant Prompt Mode，二是讓 zplug 先不要吵
關掉 Instant Prompt Mode 關掉 Instant Prompt Mode 很簡單，重新設定一次 p10k 就好了，在設定程式問你是否要開啟 p10k 時選擇 (3) Off，這樣下次安裝外掛就不會有奇怪的警告訊息跳出來了。"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.simba-fs.dev/posts/ithelp/day04/"><meta property="og:image" content="https://blog.simba-fs.dev/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-09-04T00:00:00+00:00"><meta property="article:modified_time" content="2021-09-04T00:00:00+00:00"><meta property="og:site_name" content="Simba 的喵窩"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.simba-fs.dev/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Day 04：金魚記憶力太短暫，交給外掛記吧！autosuggestions 與 sugstring-search"><meta name=twitter:description content="今天的內容會比平常多，但是非常紮實！
有時候我們在 CLI 操作時遇到很多重複的指令，像是 git add、git commit -m 'ba la ba la' 等等，這些指令可能又長又複雜，一直都是自己打也不是辦法，這時候就該請出 autosuggestions 了
安裝 autosuggestions 老樣子，安裝外掛只須要修改 ~/.zshrc 就可以了
# plugins zplug 'romkatv/powerlevel10k', as:theme, depth:1 + zplug 'zsh-users/zsh-autosuggestions' 因為 autosuggestions 是外掛，不需要特別寫 tag 了
[問題]好像有奇怪的字跑出來？ 寫好之後重開終端機，按下 enter你可能會發現跳出了一堆東西，這是因為你開啟了 p10k 的 Instant Prompt Mode，這個雖然會讓你的終端機跑起來比較順（官方說的，我感覺不出來），但是在 zsh 載入完成之前就不能有任何字輸出。
可是你看看，如果我們新增了一個外掛，zplug 會跳出來問我們是否要安裝，這時後 Instant Prompt Mode 就出來抱怨了。
這個問題的解決方法直覺上有兩個，一是關掉 Instant Prompt Mode，二是讓 zplug 先不要吵
關掉 Instant Prompt Mode 關掉 Instant Prompt Mode 很簡單，重新設定一次 p10k 就好了，在設定程式問你是否要開啟 p10k 時選擇 (3) Off，這樣下次安裝外掛就不會有奇怪的警告訊息跳出來了。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"posts","item":"https://blog.simba-fs.dev/posts/"},{"@type":"ListItem","position":2,"name":"ithelp","item":"https://blog.simba-fs.dev/posts/ithelp/"},{"@type":"ListItem","position":3,"name":"Day 04：金魚記憶力太短暫，交給外掛記吧！autosuggestions 與 sugstring-search","item":"https://blog.simba-fs.dev/posts/ithelp/day04/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Day 04：金魚記憶力太短暫，交給外掛記吧！autosuggestions 與 sugstring-search","name":"Day 04：金魚記憶力太短暫，交給外掛記吧！autosuggestions 與 sugstring-search","description":"今天的內容會比平常多，但是非常紮實！\n有時候我們在 CLI 操作時遇到很多重複的指令，像是 git add、git commit -m 'ba la ba la' 等等，這些指令可能又長又複雜，一直都是自己打也不是辦法，這時候就該請出 autosuggestions 了\n安裝 autosuggestions 老樣子，安裝外掛只須要修改 ~/.zshrc 就可以了\n# plugins zplug \u0026#39;romkatv/powerlevel10k\u0026#39;, as:theme, depth:1 + zplug \u0026#39;zsh-users/zsh-autosuggestions\u0026#39; 因為 autosuggestions 是外掛，不需要特別寫 tag 了\n[問題]好像有奇怪的字跑出來？ 寫好之後重開終端機，按下 enter你可能會發現跳出了一堆東西，這是因為你開啟了 p10k 的 Instant Prompt Mode，這個雖然會讓你的終端機跑起來比較順（官方說的，我感覺不出來），但是在 zsh 載入完成之前就不能有任何字輸出。\n可是你看看，如果我們新增了一個外掛，zplug 會跳出來問我們是否要安裝，這時後 Instant Prompt Mode 就出來抱怨了。\n這個問題的解決方法直覺上有兩個，一是關掉 Instant Prompt Mode，二是讓 zplug 先不要吵\n關掉 Instant Prompt Mode 關掉 Instant Prompt Mode 很簡單，重新設定一次 p10k 就好了，在設定程式問你是否要開啟 p10k 時選擇 (3) Off，這樣下次安裝外掛就不會有奇怪的警告訊息跳出來了。","keywords":["cli","terminal","software development","vim","tmux","zsh"],"articleBody":"今天的內容會比平常多，但是非常紮實！\n有時候我們在 CLI 操作時遇到很多重複的指令，像是 git add、git commit -m 'ba la ba la' 等等，這些指令可能又長又複雜，一直都是自己打也不是辦法，這時候就該請出 autosuggestions 了\n安裝 autosuggestions 老樣子，安裝外掛只須要修改 ~/.zshrc 就可以了\n# plugins zplug 'romkatv/powerlevel10k', as:theme, depth:1 + zplug 'zsh-users/zsh-autosuggestions' 因為 autosuggestions 是外掛，不需要特別寫 tag 了\n[問題]好像有奇怪的字跑出來？ 寫好之後重開終端機，按下 enter你可能會發現跳出了一堆東西，這是因為你開啟了 p10k 的 Instant Prompt Mode，這個雖然會讓你的終端機跑起來比較順（官方說的，我感覺不出來），但是在 zsh 載入完成之前就不能有任何字輸出。\n可是你看看，如果我們新增了一個外掛，zplug 會跳出來問我們是否要安裝，這時後 Instant Prompt Mode 就出來抱怨了。\n這個問題的解決方法直覺上有兩個，一是關掉 Instant Prompt Mode，二是讓 zplug 先不要吵\n關掉 Instant Prompt Mode 關掉 Instant Prompt Mode 很簡單，重新設定一次 p10k 就好了，在設定程式問你是否要開啟 p10k 時選擇 (3) Off，這樣下次安裝外掛就不會有奇怪的警告訊息跳出來了。\n讓 zplug 先閉嘴 如果你覺得 Instant Prompt Mode 很重要，需要保留，那你可能會想到這個方法\n在 ~/.zshrc 中有一行 zplug load，這行會讓 zplug 在 ~/.zshrc 載入時偵測是否要安裝新外掛，把這行拿掉再重新開啟終端機，以後他就不會自動檢查了\n這時候如果你要安裝新外掛，一樣是修改 ~/.zshrc 之後重開終端機，手動下指令 zplug load，zplug 就會開始檢查更新。\n有沒有兼得的方法呢？ 以上兩種方法都是治標不治本，其實 ~/.zshrc 裡面已經有寫解決辦法了，看看 ~/.zshrc 最上面的註解，這是設定 p10k 時如果你有開啟 Instant Prompt Mode 他幫你加的\n# Enable Powerlevel10k instant prompt. Should stay close to the top of ~/.zshrc. # Initialization code that may require console input (password prompts, [y/n] # confirmations, etc.) must go above this block; everything else may go below. 他說如果載入過程中會有輸出，像是問 y/N 之類的，要放到這段前面\n所以我們只需要把 zplug 搬到最前面就可以了，現在 ~/.zshrc 長這樣\nsource ~/.zplug/init.zsh # plugins zplug 'romkatv/powerlevel10k', as:theme, depth:1 zplug 'zsh-users/zsh-autosuggestions' if ! zplug check --verbose; then printf \"Install? [y/N]: \" if read -q; then echo; zplug install fi fi zplug load # Enable Powerlevel10k instant prompt. Should stay close to the top of ~/.zshrc. # Initialization code that may require console input (password prompts, [y/n] # confirmations, etc.) must go above this block; everything else may go below. if [[ -r \"${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh\" ]]; then source \"${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh\" fi # To customize prompt, run `p10k configure` or edit ~/.p10k.zsh. [[ ! -f ~/.p10k.zsh ]] || source ~/.p10k.zsh [問題]為什麼按 方向鍵上時會出現和現在指令開頭不同的字 假設你現在打過以下指令\n$ ls /home/purecli $ cat ~/.zshrc $ ls / 這時候你先打 ls，想找到之前 ls 開頭的指令按，按 方向鍵上會出現 cat ~/.zshrc 呢？這是因為現在的 方向鍵上是 zsh 本身的「上一個指令」。\n這個問題需要裝另一個外掛來解決：zsh-users/zsh-history-substring-search\n在 ~/.zshrc 新增一行\n# plugins zplug 'romkatv/powerlevel10k', as:theme, depth:1 zplug 'zsh-users/zsh-autosuggestions' + zplug 'zsh-users/zsh-history-substring-search' 然後要綁定按鍵，一樣是放在 ~/.zshrc，位置隨便\nbindkey \"$terminfo[kcuu1]\" history-substring-search-up bindkey \"$terminfo[kcud1]\" history-substring-search-down 重開終端機後就可以搜尋同樣開頭的指令紀錄了\n[問題]為什麼開新的終端機 autosuggestions 讀不到以前下過得指令？ 這是因為我們的 ~/.zshrc 中沒有設定把 history 存下來，所以 autosuggestions 只能拿到目前這個終端機的紀錄，一關掉紀錄就不見了，autosuggestions 自然找不到。\n要解決也很簡單，讓他把 history 寫進檔案就好了，在 ~/.zshrc 中任意地方新增這兩行\nSAVEHIST=1000 export HISTFILE=~/.zsh_history setopt share_history 這樣 autosuggestions 就可以讀到以前下過的指指令了\n結尾 今天介紹了好用的 autosuggestions 和 zplug 與 p10k 設定衝突的解決方法。\n不的不說 autosuggestions 真是懶人福音，打過的指令不用再打第二次\n明天再介紹兩個外掛後就 zsh 的部份就差不多完結了，緊接著會進入精彩的 tmux\n","wordCount":"332","inLanguage":"zh-tw","datePublished":"2021-09-04T00:00:00Z","dateModified":"2021-09-04T00:00:00Z","author":{"@type":"Person","name":"simba-fs"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.simba-fs.dev/posts/ithelp/day04/"},"publisher":{"@type":"Organization","name":"Simba's Blog","logo":{"@type":"ImageObject","url":"https://blog.simba-fs.dev/images/icon/icon.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.simba-fs.dev/ accesskey=h title="Home (Alt + H)"><img src=https://blog.simba-fs.dev/images/icon/icon.png alt=logo aria-label=logo height=35>Home</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://blog.simba-fs.dev/posts/ title=Categories><span>Categories</span></a></li><li><a href=https://blog.simba-fs.dev/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://blog.simba-fs.dev/archive/ title=Archives><span>Archives</span></a></li><li><a href=https://blog.simba-fs.dev/resource/ title=Resource><span>Resource</span></a></li><li><a href=https://blog.simba-fs.dev/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.simba-fs.dev/>首頁</a>&nbsp;»&nbsp;<a href=https://blog.simba-fs.dev/posts/>posts</a>&nbsp;»&nbsp;<a href=https://blog.simba-fs.dev/posts/ithelp/>ithelp</a></div><h1 class=post-title>Day 04：金魚記憶力太短暫，交給外掛記吧！autosuggestions 與 sugstring-search</h1><div class=post-meta><span title="2021-09-04 00:00:00 +0000 UTC">2021-September-4</span>&nbsp;·&nbsp;2 分鐘&nbsp;·&nbsp;simba-fs</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>目錄</span></summary><div class=inner><ul><li><a href=#%e5%ae%89%e8%a3%9d-autosuggestions aria-label="安裝 autosuggestions">安裝 autosuggestions</a><ul><li><a href=#%e5%95%8f%e9%a1%8c%e5%a5%bd%e5%83%8f%e6%9c%89%e5%a5%87%e6%80%aa%e7%9a%84%e5%ad%97%e8%b7%91%e5%87%ba%e4%be%86 aria-label=[問題]好像有奇怪的字跑出來？>[問題]好像有奇怪的字跑出來？</a><ul><li><a href=#%e9%97%9c%e6%8e%89-instant-prompt-mode aria-label="關掉 Instant Prompt Mode">關掉 Instant Prompt Mode</a></li><li><a href=#%e8%ae%93-zplug-%e5%85%88%e9%96%89%e5%98%b4 aria-label="讓 zplug 先閉嘴">讓 zplug 先閉嘴</a></li><li><a href=#%e6%9c%89%e6%b2%92%e6%9c%89%e5%85%bc%e5%be%97%e7%9a%84%e6%96%b9%e6%b3%95%e5%91%a2 aria-label=有沒有兼得的方法呢？>有沒有兼得的方法呢？</a></li></ul></li></ul></li><li><a href=#%e5%95%8f%e9%a1%8c%e7%82%ba%e4%bb%80%e9%ba%bc%e6%8c%89-kbd%e6%96%b9%e5%90%91%e9%8d%b5%e4%b8%8akbd-%e6%99%82%e6%9c%83%e5%87%ba%e7%8f%be%e5%92%8c%e7%8f%be%e5%9c%a8%e6%8c%87%e4%bb%a4%e9%96%8b%e9%a0%ad%e4%b8%8d%e5%90%8c%e7%9a%84%e5%ad%97 aria-label="[問題]為什麼按 方向鍵上時會出現和現在指令開頭不同的字">[問題]為什麼按 方向鍵上 時會出現和現在指令開頭不同的字</a></li><li><a href=#%e5%95%8f%e9%a1%8c%e7%82%ba%e4%bb%80%e9%ba%bc%e9%96%8b%e6%96%b0%e7%9a%84%e7%b5%82%e7%ab%af%e6%a9%9f-autosuggestions-%e8%ae%80%e4%b8%8d%e5%88%b0%e4%bb%a5%e5%89%8d%e4%b8%8b%e9%81%8e%e5%be%97%e6%8c%87%e4%bb%a4 aria-label="[問題]為什麼開新的終端機 autosuggestions 讀不到以前下過得指令？">[問題]為什麼開新的終端機 autosuggestions 讀不到以前下過得指令？</a></li><li><a href=#%e7%b5%90%e5%b0%be aria-label=結尾>結尾</a></li></ul></div></details></div><div class=post-content><p>今天的內容會比平常多，但是非常紮實！</p><p>有時候我們在 CLI 操作時遇到很多<strong>重複</strong>的指令，像是 <code>git add</code>、<code>git commit -m 'ba la ba la'</code> 等等，這些指令可能又長又複雜，一直都是自己打也不是辦法，這時候就該請出 <a href=https://github.com/zsh-users/zsh-autosuggestions>autosuggestions</a> 了</p><h1 id=安裝-autosuggestions>安裝 autosuggestions<a hidden class=anchor aria-hidden=true href=#安裝-autosuggestions>#</a></h1><p>老樣子，安裝外掛只須要修改 <code>~/.zshrc</code> 就可以了</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span># plugins
</span></span><span style=display:flex><span>zplug &#39;romkatv/powerlevel10k&#39;, as:theme, depth:1
</span></span><span style=display:flex><span><span style=color:#a6e22e>+ zplug &#39;zsh-users/zsh-autosuggestions&#39;
</span></span></span></code></pre></div><p>因為 <code>autosuggestions</code> 是外掛，不需要特別寫 tag 了</p><h2 id=問題好像有奇怪的字跑出來>[問題]好像有奇怪的字跑出來？<a hidden class=anchor aria-hidden=true href=#問題好像有奇怪的字跑出來>#</a></h2><p>寫好之後重開終端機，按下 enter 你可能會發現跳出了一堆東西，這是因為你開啟了 p10k 的 Instant Prompt Mode，這個雖然會讓你的終端機跑起來比較順（官方說的，我感覺不出來），但是在 zsh 載入完成之前就不能有任何字輸出。<br>可是你看看，如果我們新增了一個外掛，zplug 會跳出來問我們是否要安裝，這時後 Instant Prompt Mode 就出來抱怨了。<br>這個問題的解決方法直覺上有兩個，一是關掉 Instant Prompt Mode，二是讓 zplug 先不要吵</p><h3 id=關掉-instant-prompt-mode>關掉 Instant Prompt Mode<a hidden class=anchor aria-hidden=true href=#關掉-instant-prompt-mode>#</a></h3><p>關掉 Instant Prompt Mode 很簡單，重新設定一次 p10k 就好了，在設定程式問你是否要開啟 p10k 時選擇 <code>(3) Off</code>，這樣下次安裝外掛就不會有奇怪的警告訊息跳出來了。</p><h3 id=讓-zplug-先閉嘴>讓 zplug 先閉嘴<a hidden class=anchor aria-hidden=true href=#讓-zplug-先閉嘴>#</a></h3><p>如果你覺得 Instant Prompt Mode 很重要，需要保留，那你可能會想到這個方法<br>在 <code>~/.zshrc</code> 中有一行 <code>zplug load</code>，這行會讓 zplug 在 <code>~/.zshrc</code> 載入時偵測是否要安裝新外掛，把這行拿掉再重新開啟終端機，以後他就不會自動檢查了<br>這時候如果你要安裝新外掛，一樣是修改 <code>~/.zshrc</code> 之後重開終端機，<strong>手動</strong>下指令 <code>zplug load</code>，zplug 就會開始檢查更新。</p><h3 id=有沒有兼得的方法呢>有沒有兼得的方法呢？<a hidden class=anchor aria-hidden=true href=#有沒有兼得的方法呢>#</a></h3><p>以上兩種方法都是治標不治本，其實 <code>~/.zshrc</code> 裡面已經有寫解決辦法了，看看 <code>~/.zshrc</code> 最上面的註解，這是設定 p10k 時如果你有開啟 Instant Prompt Mode 他幫你加的</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># Enable Powerlevel10k instant prompt. Should stay close to the top of ~/.zshrc.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Initialization code that may require console input (password prompts, [y/n]</span>
</span></span><span style=display:flex><span><span style=color:#75715e># confirmations, etc.) must go above this block; everything else may go below.</span>
</span></span></code></pre></div><p>他說如果載入過程中會有輸出，像是問 y/N 之類的，要放到這段前面<br>所以我們只需要把 zplug 搬到最前面就可以了，現在 <code>~/.zshrc</code> 長這樣</p><pre tabindex=0><code>source ~/.zplug/init.zsh

# plugins
zplug &#39;romkatv/powerlevel10k&#39;, as:theme, depth:1
zplug &#39;zsh-users/zsh-autosuggestions&#39;

if ! zplug check --verbose; then
	printf &#34;Install? [y/N]: &#34;
	if read -q; then
		echo; zplug install
	fi
fi

zplug load

# Enable Powerlevel10k instant prompt. Should stay close to the top of ~/.zshrc.
# Initialization code that may require console input (password prompts, [y/n]
# confirmations, etc.) must go above this block; everything else may go below.
if [[ -r &#34;${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh&#34; ]]; then
  source &#34;${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh&#34;
fi
# To customize prompt, run `p10k configure` or edit ~/.p10k.zsh.
[[ ! -f ~/.p10k.zsh ]] || source ~/.p10k.zsh
</code></pre><h1 id=問題為什麼按-kbd方向鍵上kbd-時會出現和現在指令開頭不同的字>[問題]為什麼按 方向鍵上 時會出現和現在指令開頭不同的字<a hidden class=anchor aria-hidden=true href=#問題為什麼按-kbd方向鍵上kbd-時會出現和現在指令開頭不同的字>#</a></h1><p>假設你現在打過以下指令</p><pre tabindex=0><code>$ ls /home/purecli
$ cat ~/.zshrc
$ ls /
</code></pre><p>這時候你先打 <code>ls</code>，想找到之前 <code>ls</code> 開頭的指令按，按 方向鍵上 會出現 <code>cat ~/.zshrc</code> 呢？這是因為現在的 方向鍵上 是 zsh 本身的「上一個指令」。<br>這個問題需要裝另一個外掛來解決：<a href=https://github.com/zsh-users/zsh-history-substring-search>zsh-users/zsh-history-substring-search</a><br>在 <code>~/.zshrc</code> 新增一行</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span># plugins
</span></span><span style=display:flex><span>zplug &#39;romkatv/powerlevel10k&#39;, as:theme, depth:1
</span></span><span style=display:flex><span>zplug &#39;zsh-users/zsh-autosuggestions&#39;
</span></span><span style=display:flex><span><span style=color:#a6e22e>+ zplug &#39;zsh-users/zsh-history-substring-search&#39;
</span></span></span></code></pre></div><p>然後要綁定按鍵，一樣是放在 <code>~/.zshrc</code>，位置隨便</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span>bindkey <span style=color:#e6db74>&#34;</span>$terminfo<span style=color:#e6db74>[kcuu1]&#34;</span> history-substring-search-up 
</span></span><span style=display:flex><span>bindkey <span style=color:#e6db74>&#34;</span>$terminfo<span style=color:#e6db74>[kcud1]&#34;</span> history-substring-search-down
</span></span></code></pre></div><p><strong>重開終端機</strong>後就可以搜尋同樣開頭的指令紀錄了</p><h1 id=問題為什麼開新的終端機-autosuggestions-讀不到以前下過得指令>[問題]為什麼開新的終端機 autosuggestions 讀不到以前下過得指令？<a hidden class=anchor aria-hidden=true href=#問題為什麼開新的終端機-autosuggestions-讀不到以前下過得指令>#</a></h1><p>這是因為我們的 <code>~/.zshrc</code> 中沒有設定把 history 存下來，所以 autosuggestions 只能拿到<strong>目前這個終端機</strong>的紀錄，一關掉紀錄就不見了，autosuggestions 自然找不到。<br>要解決也很簡單，讓他把 history <strong>寫進檔案</strong>就好了，在 <code>~/.zshrc</code> 中任意地方新增這兩行</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span>SAVEHIST<span style=color:#f92672>=</span><span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>export HISTFILE<span style=color:#f92672>=</span>~/.zsh_history
</span></span><span style=display:flex><span>setopt share_history
</span></span></code></pre></div><p>這樣 autosuggestions 就可以讀到以前下過的指指令了</p><h1 id=結尾>結尾<a hidden class=anchor aria-hidden=true href=#結尾>#</a></h1><p>今天介紹了好用的 autosuggestions 和 zplug 與 p10k 設定衝突的解決方法。<br>不的不說 autosuggestions 真是懶人福音，打過的指令不用再打第二次<br>明天再介紹兩個外掛後就 zsh 的部份就差不多完結了，緊接著會進入精彩的 tmux</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.simba-fs.dev/tags/cli/>cli</a></li><li><a href=https://blog.simba-fs.dev/tags/terminal/>terminal</a></li><li><a href=https://blog.simba-fs.dev/tags/software-development/>software development</a></li><li><a href=https://blog.simba-fs.dev/tags/vim/>vim</a></li><li><a href=https://blog.simba-fs.dev/tags/tmux/>tmux</a></li><li><a href=https://blog.simba-fs.dev/tags/zsh/>zsh</a></li></ul><nav class=paginav><a class=prev href=https://blog.simba-fs.dev/posts/ithelp/day05/><span class=title>« 上一篇</span><br><span>Day 05：是說，這個選項可以接什麼東西？autocomplete 與 auto-pair</span></a>
<a class=next href=https://blog.simba-fs.dev/posts/ithelp/day03/><span class=title>下一篇 »</span><br><span>Day 03：轉吧轉吧七彩霓虹燈之 p10k</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Day 04：金魚記憶力太短暫，交給外掛記吧！autosuggestions 與 sugstring-search on twitter" href="https://twitter.com/intent/tweet/?text=Day%2004%ef%bc%9a%e9%87%91%e9%ad%9a%e8%a8%98%e6%86%b6%e5%8a%9b%e5%a4%aa%e7%9f%ad%e6%9a%ab%ef%bc%8c%e4%ba%a4%e7%b5%a6%e5%a4%96%e6%8e%9b%e8%a8%98%e5%90%a7%ef%bc%81autosuggestions%20%e8%88%87%20sugstring-search&url=https%3a%2f%2fblog.simba-fs.dev%2fposts%2fithelp%2fday04%2f&hashtags=cli%2cterminal%2csoftwaredevelopment%2cvim%2ctmux%2czsh"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Day 04：金魚記憶力太短暫，交給外掛記吧！autosuggestions 與 sugstring-search on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fblog.simba-fs.dev%2fposts%2fithelp%2fday04%2f&title=Day%2004%ef%bc%9a%e9%87%91%e9%ad%9a%e8%a8%98%e6%86%b6%e5%8a%9b%e5%a4%aa%e7%9f%ad%e6%9a%ab%ef%bc%8c%e4%ba%a4%e7%b5%a6%e5%a4%96%e6%8e%9b%e8%a8%98%e5%90%a7%ef%bc%81autosuggestions%20%e8%88%87%20sugstring-search&summary=Day%2004%ef%bc%9a%e9%87%91%e9%ad%9a%e8%a8%98%e6%86%b6%e5%8a%9b%e5%a4%aa%e7%9f%ad%e6%9a%ab%ef%bc%8c%e4%ba%a4%e7%b5%a6%e5%a4%96%e6%8e%9b%e8%a8%98%e5%90%a7%ef%bc%81autosuggestions%20%e8%88%87%20sugstring-search&source=https%3a%2f%2fblog.simba-fs.dev%2fposts%2fithelp%2fday04%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Day 04：金魚記憶力太短暫，交給外掛記吧！autosuggestions 與 sugstring-search on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fblog.simba-fs.dev%2fposts%2fithelp%2fday04%2f&title=Day%2004%ef%bc%9a%e9%87%91%e9%ad%9a%e8%a8%98%e6%86%b6%e5%8a%9b%e5%a4%aa%e7%9f%ad%e6%9a%ab%ef%bc%8c%e4%ba%a4%e7%b5%a6%e5%a4%96%e6%8e%9b%e8%a8%98%e5%90%a7%ef%bc%81autosuggestions%20%e8%88%87%20sugstring-search"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Day 04：金魚記憶力太短暫，交給外掛記吧！autosuggestions 與 sugstring-search on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.simba-fs.dev%2fposts%2fithelp%2fday04%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Day 04：金魚記憶力太短暫，交給外掛記吧！autosuggestions 與 sugstring-search on whatsapp" href="https://api.whatsapp.com/send?text=Day%2004%ef%bc%9a%e9%87%91%e9%ad%9a%e8%a8%98%e6%86%b6%e5%8a%9b%e5%a4%aa%e7%9f%ad%e6%9a%ab%ef%bc%8c%e4%ba%a4%e7%b5%a6%e5%a4%96%e6%8e%9b%e8%a8%98%e5%90%a7%ef%bc%81autosuggestions%20%e8%88%87%20sugstring-search%20-%20https%3a%2f%2fblog.simba-fs.dev%2fposts%2fithelp%2fday04%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Day 04：金魚記憶力太短暫，交給外掛記吧！autosuggestions 與 sugstring-search on telegram" href="https://telegram.me/share/url?text=Day%2004%ef%bc%9a%e9%87%91%e9%ad%9a%e8%a8%98%e6%86%b6%e5%8a%9b%e5%a4%aa%e7%9f%ad%e6%9a%ab%ef%bc%8c%e4%ba%a4%e7%b5%a6%e5%a4%96%e6%8e%9b%e8%a8%98%e5%90%a7%ef%bc%81autosuggestions%20%e8%88%87%20sugstring-search&url=https%3a%2f%2fblog.simba-fs.dev%2fposts%2fithelp%2fday04%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://blog.simba-fs.dev/>Simba's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>